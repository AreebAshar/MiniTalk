#!/bin/zsh

PATH_TO_CLIENT="/Users/hualhash/Desktop/MIniTalk/MiniTalk/client"

# Colors
Black='\e[0;30m'
D_Gray='\e[1;30m'
Red='\e[0;31m'
L_Red='\e[1;31m'
Green='\e[0;32m'
L_Green='\e[1;32m'
Orange='\e[0;33m'
Yellow='\e[1;33m'
Blue='\e[0;34m'
L_Blue='\e[1;34m'
Purple='\e[0;35m'
L_Purple='\e[1;35m'
Cyan='\e[0;36m'
L_Cyan='\e[1;36m'
L_Gray='\e[0;37m'
White='\e[1;37m'
NC='\e[0m' 

###################
# Preparing tests #
###################

for init in tm tb t2 t3 t4 t5 t6 p_id
do
    export $init=0
done

for i in $@
do
    case $i in
        -m) tm=1;;
        -b) tb=1;;
        "-1") t1=1;;
        "-2") t2=1;;
        "-3") t3=1;;
        "-4") t4=1;;
        "-5") t5=1;;
        "-6") t6=1;;
        *) if [[ $p_id = 0 ]] ; then p_id=$i; else echo "[ERROR] Please enter correct arg when launching."; exit; fi;;
    esac
done

if ! [[ $p_id =~ [0-9]+ ]]
then 
    echo "[ERROR] Please enter correct arg when launching."
    exit
fi


###########
# Testing #
###########

######## SPEED TEST #########

echo "${L_Green} [Speed test]\tTime to print 1 000 char ${NC}"
time $PATH_TO_CLIENT $p_id "...................................................................................................
...................................................................................................
...................................................................................................
...................................................................................................
...................................................................................................
...................................................................................................
...................................................................................................
...................................................................................................
...................................................................................................
...................................................................................................
"



######## MANDATORY #########

### Test 1 ###
if [[ $t1 == 1 || $tm == 1 ]]
then
    echo "${L_Green} [Test 1]\tBasic test ${NC}"
    $PATH_TO_CLIENT $p_id "Hello, this is a first test" 
fi

### Test 2 ###
if [[ $t2 == 1 || $tm == 1 ]]
then
    echo "${L_Green}\n [Test 2]\tEmpty string${NC}"
    $PATH_TO_CLIENT $p_id "" 
fi

### Test 3 ###
if [[ $t3 == 1 || $tm == 1 ]]
then
    echo "${L_Green}\n [Test 3]\tSending big str with 20 000 char${NC}"
    $PATH_TO_CLIENT $p_id "
 .  . .  .  . .  .  . .  .  . .  .  . .  .  . .  .  . .  .  . .  .  . .  .  . .  .  . .  .  . .  .  . .  .  . .  .  .  
   .       .       .       .       .       .       .       .       .       .       .       .       .       .       .   .
     .  .    .  .    .  .    .  .    .  .    .  .    .  .    .  .    .  .    .  .    .  .    .  .    .  .    .  .    .  
 .       .       .       .       .       .       .       .%%     .       .       .       .       .       .       .      
   .  .    .  .    .  .    .  .    .  .    .  .    .  .   @S  .    .  .    .  .    .  .    .  .    .  .    .  .    .  . 
  .    .  .    .  .    .  .    .  .    .  .    .  .    .  @S    .   .   .   .   .   .   .   .   .   .   .   .   .   .   
    .       .       .       .       .       .       .    .88. .   .   .   .   .   .   .   .   .   .   .   .   .   .    .
  .   . .    .  .    .  .    .  .    .  .    .  .    .  .8. t   .       .       .       .       .       .       .    .  
    .     .    .  .    .  .    .  .    .  .    .  .      8  %      . .     . .     . .     . .     . .     . .     .    
  .    .   .       .       .       .       .       .  . .%tX:. .  .    .       .       .       .       .       .     .  
     .   .   .  .    .  .    .  .    .  .    .  .    .   X8@%        .   . .     . .     . .     . .     . .     . .   .
  .    .      .   .   .   .   .   .   .   .   .   .     .@  % . .  .         . .     . .     . .     . .     . .     .  
    .     . .   .   .   .   .   .   .   .   .   .   .   S %:.X    .   . .  .     .       .       .       .       .      
  .   .           .       .       .       .       .   . ;ttX % .    .        .     . .     . .     . .     . .     .  . 
    .   . .  . .     . .     . .     . .     . .        ;.. 8;   .     . . .   .  .    .  .    .  .    .  .    .  .     
  .         .    .       .       .       .       .  . . ;8   %     .  .         .    .   .   .   .   .   .   .   .  . . 
     . .  .    .   . .     . .     . .     . .     .   S.:t8.;. .        .  . .    .   .       .       .       .        
  .          .         . .     . .     . .     . .    .  %X@;%    . .  .         .        . .     . .     . .     .  .  
    .  . . .    . .  .     .       .       .        .  @:  % S .      .   .  .  .   . . .     .  .    .  .    .  .     .
  .           .        .     . .     . .     . .  .    S: X. 88:  .     .   .     .        .   .    .       .      .    
    . .  .  .    . . .   .  .    .  .    .  .        . S: S S% :    .     .   .     .  .    .     .   . .     . .    .  
  .       .   .           .    .   .   .   .   . . .   S: S @ S@ .   . .        . .      .    .     .     . .     .   . 
     . .        .  .  . .    .   .       .            .S: S @.SX   .     .  . .      .  .  .    . .    .       .    .   
  .      . . .    .        .        . .     . .  .  .  SXX;%@S.@ .    .    .     .  .        .       .   .  .    .     .
    .  .       .    .  .  .   . . .     .  .       .    8%:;8.XX    .   .     .       .  . .   .  .        .  .    . .  
  .      .  .    .      .   .        .   .    . .    . @: S.8.S@  .       . .   . .    .     .      .  . .      .       
    . .       .    . .         .  .    .    .     .    S:   X SX.    . .      .     .    .     . .   .      .    .  .  .
  .     .  .    .      .  .  .      .     .    .    .8: XX  X S@   .     .  .    .   .     .       .    .  .  .         
     .    .  .    .  .   .     . .    .  .   .   .  ; S.t . @ SX .   .  .      .   .   .  .  .  .     .        .  . . . 
  .    .       .       .   . .     .   .       .    ; 8 t : 8 S@       .  .  .          .     .   .  .   .  .    .      
    .    . .    .  . .          .    .    . .    .  ; 8.; t:8.  %@. .       .   . .  .     .    .      .   .  .     .  .
  .   .      .    .     . .  .    .     .     .    .; 8.t.%.  :;S.X   .  .    .     .  .  .  .     .     .      .       
    .   .  .   .     .         .    .  .   .    .   ; 8.t.S.  . S X.    .  .    .  .           .  .  . .    .    . . .  
  .          .   .     .  . .    .   .   .   .    . ; 8.;.%   ;;S X  .       .       .  .  .              .   .        .
     . . . .       . .        .    .           .    ;;X;%%8XXXSXX8X    .  .    . .     .    . . .  .  .  .   .  .  .    
  .           . .      . .  .   .     .  . .  .  .  ;%%  t. .8t8:%X. .      .      . .   .        .    .   .         .  
    .  .  .  .    . .         .   .  .       .     .;.8 ;.St. ;.S;@    . .    .  .        .  .  .   .         .  . .   .
  .     .       .     .  . .    .      .  .     .   %.;t;.X;  : S X  .     .       .  . .            .  . .    .     .  
    . .    .  .   .          .     .    .   .  .  .:..  %.%.  : % X    .     . .           .  .  . .        .    .      
  .      .   .      . . .  .   .  .  .    .       . ;.8 %.%.  . S X .    . .     .  . .  .     .      .  .   .     .  . 
     .     .   . .           .        .      .  . . @ 8 % S S : % X   .       .   .        . .    .  .     .   .  .     
  .    . .         .  .  . .    .  .    .  .   .  . @ 8 %.%   : Xtt8:   .  .    .    . .        .      . .   .   .  . . 
    .       . .  .      .     .   .  .    .       . @ 8 %.%.  . .:.; 8.   .  .    .      . .  .   . .      .            
  .   .  .         . .     .    .      .    . .     @ 8 % %.  . .X  S;  .      .    .  .     .        .  .    . .  .  . 
    .      .  . .      . .   .     .    .       . . @ 8 %.S S : .X   S     .  .  .    .   .    . .  .       .       .   
  .    . .        .  .     .   .    . .   .  .    . 8.8 %.%   : .X  Xt.  .         .    .   .         . .      . .     .
     .     . .  .       .        .         .   .     X@%;t@. .:. S @Xt .   . .  .    .    .   .  . .      . .      . .  
  .    .          . . .   .  . .   .  . .    .   .  .:.        ..:8t;t         .  .    .             .  .     .  .      
    .    .  . . .           .    .        .    .  . :@.SS888@@;tX .t t  . .  .      .    . . . .  .       .  .      .  .
  .   .   .        .  . .      .    .  .    .     . @ 8:%.;   : :8. St      .   .    .              . .        . .      
    .   .    .  .         .  .    .   .  .    . ;:88 S8 S t.  . .X   S .  .      . .   .  .  .  . .     .  . .     . .  
  .        .      . .  .   .    .   .      .    @88X S8 % %.  . .X  X;       . .        .      .     .   .      .      .
     . .  .   . .        .    .        .    .  .%;  %%8 % S S : .X  %t . . .      .  .    . .     .    .    .     .  .  
  .     .   .      . . .    .    . . .   .      %; . X8 % %   : .X.t%St%      .     .  .      .  .  .     .   . .       
    .          .          .    .       .   . .  %;  Xt8 S %.  . .@%:.S; t  .    . .      .  .         .  .        . . . 
  .   .  . .  .  .  .  .    .    .  .    .       % . S8 %.% S : .XS.S X %    .       .    .   . .  .   .   . .  .       
    .   .    .    .      .    .       .     . . X;  Xt8 S.t   : .@S.S X %.  .  .  .    .          .  .             .  . 
  .   .    .    .    . .   .    . .     .  .     %;;  8 %.%.  :.. 8tt:.:S       .   .   .  . .  .       . .  . . .      
         .    .    .     .   .      . .         %S88:;X;8;;X@S8@%;X;@@88%  .  .      .             .  .             .  .
  . .  .    .    .   .     .   .  .      .  .   %:   ::S88888@;t@ X.S @ % .      . .   . . .  . .    .   . .  .  .    . 
      .   .    .   .   .     .      .  .   .  . %;  S%8 S.;.  : :8S S X %   .  .             .    .    .     .     .    
  .     .    .          . .     . .      .      %;   S8 %.t   . .@S S X S    .    .  . .  .     .   .     .    .    .   
    .      .   . .  . .     .  .     . .    .   %;  S%8 % %.  . .X% S.X % .    .    .       .     .   .     .    .    . 
  .   .  .   .     .     .        .       .   . %;   X8 %.%.% : .@S S X %  .     .     . .    . .       . .   .   .  .  
    .   .       .     .    . .  .   .  .    .   %;  St8 S.%.  : .XS S X S    . .   .  .    .       . .      .   .       
  .   .   . .     .     .      .     .   .      %;   S8 %.t   . .@S S X % .      .       .   .  .     .  .         .  . 
              . .   . .   .  .   . .    t%%t%%t%.8%% X;;:S8;:;.%8 .% %.%:%%%t%t@    .  .   .     .  .   .   . .  .   .  
  . .  . .  .     .     .             . ;888888888888888888@88888888888@8888888% .   .       . .          .     .       "
fi

### Test 4 ###
if [[ $t4 == 1 || $tm == 1 ]]
then
    echo "${L_Green}\n [Test 4]\tTrying to crash your exhange Server-Client, sending str with 3 000 char (15 times) ${NC}"

    for i in {1..15}
    do
        echo -n "${Green} [ ${i} ]${NC}"
        $PATH_TO_CLIENT $p_id "
‚†Ä‚†Ä‚†Ä‚†Ä‚£¥‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚£¶‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚†à‚†ª‚£∑‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚¢Ä‚£Ä‚£ø‚£ø‚£∂‚£∂‚£æ‚£ø‚£∂‚†∂‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†à‚†õ‚£ø‚£ø‚°ü‚†õ‚†õ‚†õ‚¢ª‚£¶‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚£ø‚£ø‚†è‚¢Ä‚£æ‚£ø‚£Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚°ø‚†É‚£∞‚£ø‚£ø‚£ø‚£ø‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚£∑‚£Ä‚£Ä‚£Ä‚£Ä‚†Ä‚¢∏‚£∑‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚°ü‚£ø‚£ø‚£ø‚†ü‚¢Å‚£¥‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚°á‚£ø‚°ø‚†É‚£†‚£ø‚£ø‚£ø‚£ø‚°Ü‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚°á‚£ø‚£á‚£Ä‚£â‚£â‚°â‚†â‚£ø‚°á‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚°á‚£ø‚£ø‚£ø‚£ø‚†ã‚¢Ä‚£¥‚£ø‚†Å‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚°á‚¢∏‚£ø‚†ü‚¢Å‚£¥‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä
‚†∞‚†∂‚†∂‚†∂‚†ø‚†∑‚†æ‚†ø‚†∂‚†ø‚†ø‚†ø‚†ø‚†ø‚†∂‚†∂‚†∂‚†Ü " 
    done
fi

######## BONUS #########

### Test 5 ###
if [[ $t5 == 1 || $tb == 1 ]]
then
    echo "${L_Green}\n [Test 5]\tGuess the movie with emojis ${NC}"

    $PATH_TO_CLIENT $p_id "
     ‚õ¥Ô∏è  +  üåä  + üí• = ‚ùì
     üë¶ +  üëΩ  + üö≤ = ‚ùì
     üè∞ +  ‚ùÑÔ∏è   + üë≠ = ‚ùì
    " 
fi

### Test 6 ###
if [[ $t6 == 1 || $tb == 1 ]]
then
    echo "${L_Green}\n [Test 6]\tTesting the connexion between server-client, sending str with 5 300 char (10 times)${NC}"
    for i in {1..10}
    do
        echo -n "${L_Green} [ ${i} ]${NC}"
        $PATH_TO_CLIENT $p_id "
                             ÔºøÔºø
„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄüå∏Ôºû„ÄÄ„ÄÄ„Éï
„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ| „ÄÄ_„ÄÄ _ l
„ÄÄ „ÄÄ„ÄÄ„ÄÄÔºè` „ÉüÔºøx„Éé
„ÄÄ„ÄÄ „ÄÄ /„ÄÄ„ÄÄ„ÄÄ „ÄÄ |
„ÄÄ„ÄÄ„ÄÄ /„ÄÄ „ÉΩ„ÄÄ„ÄÄ Ôæâ
„ÄÄ „ÄÄ ‚îÇ„ÄÄ„ÄÄ|„ÄÄ|„ÄÄ|
„ÄÄÔºèÔø£|„ÄÄ„ÄÄ |„ÄÄ|„ÄÄ|
„ÄÄ| (Ôø£„ÉΩÔºø_„ÉΩ_)__)
„ÄÄÔºº‰∫å„Å§        " 
    done
fi

echo "\nIf all was corrrectly display on your server terminal: Perfect, well done! üí™"
